---
import Header from '@/components/Header.astro';
import Head from '@/components/Head.astro';
import Footer from '@/components/Footer.astro';
import { SITE } from '@/consts';
import {
  getLangFromUrl,
  getRouteFromUrl,
  localizePath,
  type Lang,
} from '@/i18n/utils';

type Props = {
  title: string;
  description: string;
  alternates?: Partial<Record<Lang, string>>;
};

const { title, description, alternates } = Astro.props as Props;
const lang = getLangFromUrl(Astro.url);
const route = getRouteFromUrl(Astro.url);

const defaultAlternates: Partial<Record<Lang, string>> = {
  en: localizePath('en', route),
  es: localizePath('es', route),
};

const mergedAlternates = { ...defaultAlternates, ...(alternates ?? {}) };
---

<!doctype html>
<html lang={lang}>
  <head>
    <Head
      title={`${title} | ${SITE.NAME}`}
      description={description}
      lang={lang}
      alternates={mergedAlternates}
    />
  </head>
  <body>
    <Header />
    <main>
      <slot />
    </main>
    <Footer alternates={mergedAlternates} />
  </body>
</html>
