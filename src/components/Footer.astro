---
import Container from '@/components/Container.astro';
import { SITE } from '@/consts';
import BackToTop from '@/components/BackToTop.astro';
import {
  getLangFromUrl,
  getRouteFromUrl,
  localizePath,
  type Lang,
} from '@/i18n/utils';
import { useTranslations } from '@/i18n/utils';

type Props = {
  alternates?: Partial<Record<Lang, string>>;
};

const { alternates } = Astro.props as Props;

const currentYear = new Date().getFullYear();
const route = getRouteFromUrl(Astro.url);
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const switchLangHref = (targetLang: Lang) => {
  return alternates?.[targetLang] ?? localizePath(targetLang, route);
};
---

<footer class="animate">
  <Container>
    <div class="relative">
      <div class="-top-20 right-0 absolute">
        <BackToTop label={t('common.backToTop')} />
      </div>
    </div>

    <div class="flex justify-between items-center">
      <div class="flex items-center gap-1">
        &copy; {currentYear} | <a
          href="https://x.com/vrgs_0"
          target="_blank"
          rel="noopener noreferrer">{SITE.NAME}</a
        >
      </div>

      <div class="flex items-center gap-1 bg-muted p-0.5 rounded-full text-xs">
        <a
          href={switchLangHref('en')}
          data-lang="en"
          class:list={[
            'px-2 py-0.5 rounded-full transition-all no-underline',
            lang === 'en'
              ? 'bg-background text-foreground font-medium shadow-sm'
              : 'text-muted-foreground hover:text-foreground',
          ]}
        >
          EN
        </a>

        <a
          href={switchLangHref('es')}
          data-lang="es"
          class:list={[
            'px-2 py-0.5 rounded-full transition-all no-underline',
            lang === 'es'
              ? 'bg-background text-foreground font-medium shadow-sm'
              : 'text-muted-foreground hover:text-foreground',
          ]}
        >
          ES
        </a>
      </div>
    </div>
  </Container>
</footer>
